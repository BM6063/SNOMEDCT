---
title: "SNOMED CT Exercise: Breast Cancer Coding with Rdiagnosislist"
author: "MAUREEN IWEGBU"
format: pdf
editor: visual
---

## Exercise: Exploring SNOMED CT for Breast Cancer Research Using Rdiagnosislist

## STEPS

Load packages Rdiagnosislist and data.table

```{r}
library(Rdiagnosislist)
```

```{r}
library(knitr)
library(dplyr)
library(tidyr)
```


```{r}
library(data.table)
```

## Load SNOMED CT release files.

```{r}
SNOMED_DICT <- loadSNOMED(c("SnomedCT_UKClinicalRF2_PRODUCTION_20250924T000001Z",
 "SnomedCT_InternationalRF2_PRODUCTION_20251001T120000Z"))
fread('SnomedCT_InternationalRF2_PRODUCTION_20251001T120000Z/Snapshot/Terminology/sct2_Concept_Snapshot_INT_20251001.txt', 
      sep = "\t", 
      quote = "",
      encoding = "UTF-8",
      colClasses = "character")

```

```{r}
saveRDS(SNOMED_DICT, file = 'mySNOMED_DICT.RDS')
```

```{r}
SNOMED_DICT <- readRDS('mySNOMED_DICT.RDS')
```

## Search for Breast cancer Concept in SNOMED CT using the term Malignant neoplasm of breast

```{r}
mn_concept <- SNOMEDconcept('malignant neoplasm of breast', SNOMED=SNOMED_DICT, 
                            exact_match = FALSE) 
description(mn_concept, SNOMED = SNOMED_DICT)
kable(mn_concept)
```

```{r}
write.csv(mn_concept, 'C:/Users/maure/Desktop/BB Cancer/myfilee.csv', row.names = FALSE)
```


```{r}
mn_mm <- description(mn_concept, SNOMED = SNOMED_DICT)
```

## Including Descendants

```{r}
mn_codelist <- SNOMEDcodelist(mn_concept, include_desc=TRUE, SNOMED=SNOMED_DICT)
print(mn_codelist)
kable(mn_codelist)
```

Refine concept to show hormone positive for breast cancer

```{r}
hmn_concept <- SNOMEDconcept('Hormone receptor positive malignant neoplasm of breast', SNOMED = SNOMED_DICT, exact = FALSE) 
print(hmn_concept)
```

## Create codelist

```{r}
hmn_codelist <- SNOMEDcodelist(hmn_concept, include_desc=TRUE, SNOMED=SNOMED_DICT)
print(hmn_codelist)
```

## Map to ICD 10

```{r}
hmn_icd10_map <- getMaps(hmn_codelist, to='icd10', SNOMED=SNOMED_DICT)
print(hmn_icd10_map)
```

```{r}
dt_hmn <-data.table(hmn_icd10_map)
dt_hmn <- dt_hmn %>%
unnest(icd10_code)
data.table(dt_hmn)
```

```{r}
kable(dt_hmn)
```
